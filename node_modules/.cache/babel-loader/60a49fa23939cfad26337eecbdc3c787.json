{"ast":null,"code":"import Foundation from \"@microsoft/fast-components-foundation-react\";\nimport { classNames, keyCodeArrowDown, keyCodeArrowUp, keyCodeEnter, keyCodeEscape, keyCodeTab } from \"@microsoft/fast-web-utilities\";\nimport React from \"react\";\nimport { Listbox, TextField, TextFieldType } from \"../index\";\nimport { DisplayNamePrefix } from \"../utilities\";\nimport { AutoSuggestContext } from \"./auto-suggest-context\";\nimport { isNil } from \"lodash-es\";\n\nclass AutoSuggest extends Foundation {\n  /**\n   * constructor\n   */\n  constructor(props) {\n    super(props);\n    /**\n     * Handled props instantiation\n     */\n\n    this.handledProps = {\n      isMenuOpen: void 0,\n      disabled: void 0,\n      label: void 0,\n      inputRegion: void 0,\n      managedClasses: void 0,\n      initialValue: void 0,\n      value: void 0,\n      onValueChange: void 0,\n      onInvoked: void 0,\n      placeholder: void 0,\n      listboxId: void 0,\n      filterSuggestions: void 0\n    };\n    this.rootElement = React.createRef();\n    this.shouldFocusMenuOnNextRender = false;\n    /**\n     * The default function that renders an unstyled content display\n     */\n\n    this.defaultInputRegionRenderFunction = (props, state, onChange, onClick, onKeyDown) => {\n      const listboxId = state.isMenuOpen ? props.listboxId : null;\n      const activedescendantId = state.focusedItem !== null ? state.focusedItem.id : null;\n      return React.createElement(TextField, {\n        disabled: props.disabled,\n        onChange: onChange,\n        onClick: onClick,\n        onKeyDown: onKeyDown,\n        value: state.value,\n        type: TextFieldType.text,\n        role: \"combobox\",\n        \"aria-label\": props.label || null,\n        \"aria-autocomplete\": \"both\",\n        \"aria-activedescendant\": activedescendantId || null,\n        \"aria-owns\": listboxId || null,\n        \"aria-controls\": listboxId || null\n      });\n    };\n    /**\n     * Updates selection state and associated values\n     */\n\n\n    this.updateFocusedItem = newSelection => {\n      if (newSelection.length === 0) {\n        this.setState({\n          focusedItem: null\n        });\n      } else {\n        this.setState({\n          focusedItem: newSelection[0]\n        });\n        this.updateValue(newSelection[0].value, true);\n      }\n    };\n    /**\n     * Handles clicks\n     */\n\n\n    this.handleInputRegionClick = e => {\n      if (this.props.disabled || e.defaultPrevented) {\n        return;\n      }\n\n      this.toggleMenu(true);\n    };\n    /**\n     * Handles item invoked\n     */\n\n\n    this.handleItemInvoked = item => {\n      this.invoke(item.value, item);\n      this.storedValueString = this.state.value;\n      this.toggleMenu(false);\n    };\n    /**\n     * Invokes the auto-select component\n     */\n\n\n    this.invoke = (value, item) => {\n      if (typeof this.props.onInvoked === \"function\") {\n        this.props.onInvoked(value, item);\n      }\n    };\n    /**\n     * Handles value changes from input element\n     */\n\n\n    this.handleChange = e => {\n      const newValue = e.target.value;\n      this.storedValueString = newValue;\n      this.updateValue(newValue, false);\n    };\n    /**\n     * Update the currentValue of the component\n     */\n\n\n    this.updateValue = (newValue, isFromSuggestedOption) => {\n      if (typeof this.props.onValueChange === \"function\") {\n        this.props.onValueChange(newValue, isFromSuggestedOption);\n      }\n\n      if (isNil(this.props.value) && newValue !== this.state.value) {\n        this.toggleMenu(true);\n        this.setState({\n          value: newValue\n        });\n      }\n    };\n    /**\n     * Handles input region key events\n     */\n\n\n    this.handleInputRegionKeydown = e => {\n      if (this.props.disabled || e.defaultPrevented) {\n        return;\n      }\n\n      switch (e.keyCode) {\n        case keyCodeEnter:\n          this.invoke(this.state.value, null);\n          break;\n\n        case keyCodeEscape:\n          this.toggleMenu(false);\n          break;\n\n        case keyCodeArrowDown:\n          this.focusOnMenu(1);\n          e.preventDefault();\n          break;\n\n        case keyCodeArrowUp:\n          this.focusOnMenu(-1);\n          e.preventDefault();\n          break;\n\n        case keyCodeTab:\n          // Prevent default case handling for tab\n          break;\n\n        default:\n          if (e.target instanceof HTMLInputElement) {\n            const newValue = e.target.value;\n            this.updateValue(newValue, false);\n            this.focusOnInput();\n            break;\n          }\n\n      }\n    };\n    /**\n     * Handles menu key events\n     */\n\n\n    this.handleMenuKeydown = e => {\n      if (this.props.disabled || e.defaultPrevented) {\n        return;\n      }\n\n      switch (e.keyCode) {\n        case keyCodeEscape:\n          this.toggleMenu(false);\n          break;\n\n        case keyCodeArrowDown:\n          if (this.checkForMenuEnd(1) === true) {\n            e.preventDefault();\n          }\n\n          break;\n\n        case keyCodeArrowUp:\n          if (this.checkForMenuEnd(-1) === true) {\n            e.preventDefault();\n          }\n\n          break;\n\n        default:\n          if (this.isValidInput(e)) {\n            this.focusOnInput();\n          }\n\n          break;\n      }\n    };\n    /**\n     * test if a key press is a valid input\n     */\n\n\n    this.isValidInput = e => {\n      if (e.keyCode < 8 || e.keyCode > 8 && e.keyCode < 48 || e.keyCode > 90 && e.keyCode < 96 || e.keyCode > 111 && e.keyCode < 186 || e.keyCode > 222) {\n        return false;\n      }\n\n      return true;\n    };\n    /**\n     * Passes focus to the input element if focus would bump up against the ends of the menu,\n     * return true if result was focusing on input region\n     */\n\n\n    this.checkForMenuEnd = increment => {\n      if (this.state.focusedItem === null) {\n        return false;\n      }\n\n      const childrenAsArray = React.Children.toArray(this.renderChildren());\n      const currentItemIndex = Listbox.getItemIndexById(this.state.focusedItem.id, this.renderChildren());\n      const startIndex = currentItemIndex + increment;\n\n      if (startIndex > childrenAsArray.length - 1 || startIndex < 0) {\n        this.setState({\n          value: this.storedValueString\n        }); // at the end of the list, focus on input\n\n        this.focusOnInput();\n        return true;\n      }\n\n      const endIndex = increment > -1 ? childrenAsArray.length - 1 : 0;\n      const nextFocusableItem = Listbox.getFirstValidOptionInRange(startIndex, endIndex, childrenAsArray, increment).props;\n\n      if (nextFocusableItem === null || nextFocusableItem.id === this.state.focusedItem.id) {\n        this.setState({\n          value: this.storedValueString\n        }); // at the end of the list, focus on input\n\n        this.focusOnInput();\n        return true;\n      }\n\n      return false;\n    };\n    /**\n     * Opens menu and focuses on first or last valid item\n     */\n\n\n    this.focusOnMenu = increment => {\n      this.storedValueString = this.state.value;\n      const childrenAsArray = React.Children.toArray(this.renderChildren());\n\n      if (childrenAsArray.length === 0) {\n        return;\n      }\n\n      const startIndex = increment > -1 ? 0 : childrenAsArray.length - 1;\n      const endIndex = increment > -1 ? childrenAsArray.length - 1 : 0;\n      this.focusFirstItemInRange(startIndex, endIndex, childrenAsArray, increment);\n      this.toggleMenu(true);\n      this.shouldFocusMenuOnNextRender = true;\n    };\n    /**\n     * Gets first child in a range\n     */\n\n\n    this.focusFirstItemInRange = (startIndex, endIndex, childrenAsArray, increment) => {\n      const validOption = Listbox.getFirstValidOptionInRange(startIndex, endIndex, childrenAsArray, increment);\n\n      if (validOption !== null) {\n        this.updateFocusedItem([validOption.props]);\n      }\n    };\n    /**\n     * Toggles the menu\n     */\n\n\n    this.toggleMenu = desiredMenuState => {\n      const updatedIsMenuOpen = this.validateMenuState(desiredMenuState);\n\n      if (updatedIsMenuOpen !== this.state.isMenuOpen) {\n        this.setState({\n          isMenuOpen: updatedIsMenuOpen\n        });\n\n        if (this.state.isMenuOpen && !updatedIsMenuOpen) {\n          this.setState({\n            value: this.storedValueString\n          });\n          this.focusOnInput();\n        }\n      }\n    };\n    /**\n     * Focus on the input element\n     */\n\n\n    this.focusOnInput = () => {\n      if (this.rootElement.current === null) {\n        return;\n      }\n\n      const inputElements = this.rootElement.current.getElementsByTagName(\"input\");\n\n      if (inputElements.length > 0) {\n        inputElements[0].focus();\n      }\n\n      this.updateFocusedItem([]);\n    };\n    /**\n     * Determine menu state by comparing desired state to props\n     */\n\n\n    this.validateMenuState = desiredMenuState => {\n      return typeof this.props.isMenuOpen === \"boolean\" ? this.props.isMenuOpen : React.Children.count(this.renderChildren()) === 0 ? false : desiredMenuState;\n    };\n    /**\n     * Close the menu when when there are clicks outside\n     */\n\n\n    this.handleWindowClick = event => {\n      if (this.state.isMenuOpen && this.rootElement.current !== null && !this.rootElement.current.contains(event.target)) {\n        this.toggleMenu(false);\n      }\n    };\n\n    const value = this.props.value === undefined ? this.props.initialValue : this.props.value;\n    this.state = {\n      value,\n      focusedItem: null,\n      isMenuOpen: this.validateMenuState(false)\n    };\n    this.storedValueString = value;\n  }\n\n  componentDidUpdate(prevProps) {\n    const updatedMenuVisibility = this.validateMenuState(this.state.isMenuOpen);\n\n    if (updatedMenuVisibility !== this.state.isMenuOpen) {\n      this.toggleMenu(updatedMenuVisibility);\n    }\n\n    if (this.props.value !== prevProps.value) {\n      this.setState({\n        value: this.props.value\n      });\n    }\n  }\n\n  componentDidMount() {\n    window.addEventListener(\"click\", this.handleWindowClick);\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener(\"click\", this.handleWindowClick);\n  }\n  /**\n   * Renders the component\n   */\n\n\n  render() {\n    return React.createElement(\"div\", Object.assign({}, this.unhandledProps(), {\n      ref: this.rootElement,\n      className: this.generateClassNames()\n    }), React.createElement(AutoSuggestContext.Provider, {\n      value: {\n        currentValue: this.storedValueString\n      }\n    }, this.renderInputRegion(), this.renderMenu()));\n  }\n  /**\n   * Create class names\n   */\n\n\n  generateClassNames() {\n    const _this$props$managedCl = this.props.managedClasses,\n          autoSuggest = _this$props$managedCl.autoSuggest,\n          autoSuggest__disabled = _this$props$managedCl.autoSuggest__disabled,\n          autoSuggest__menuOpen = _this$props$managedCl.autoSuggest__menuOpen;\n    return super.generateClassNames(classNames(autoSuggest, [autoSuggest__disabled, this.props.disabled], [autoSuggest__menuOpen, this.state.isMenuOpen]));\n  }\n  /**\n   * Determine which function to use to render content display (ie. the part of the control that shows when the menu isn't open)\n   * and invokes it\n   */\n\n\n  renderInputRegion() {\n    if (typeof this.props.inputRegion === \"function\") {\n      return this.props.inputRegion(this.props, this.state, this.handleChange, this.handleInputRegionClick, this.handleInputRegionKeydown);\n    } else {\n      return this.defaultInputRegionRenderFunction(this.props, this.state, this.handleChange, this.handleInputRegionClick, this.handleInputRegionKeydown);\n    }\n  }\n  /**\n   * Determine which function to use to render the menu and invokes it\n   */\n\n\n  renderMenu() {\n    const shouldFocusOnMenu = this.shouldFocusMenuOnNextRender;\n    const _this$props$managedCl2 = this.props.managedClasses,\n          autoSuggest_menu = _this$props$managedCl2.autoSuggest_menu,\n          autoSuggest__disabled = _this$props$managedCl2.autoSuggest__disabled;\n    this.shouldFocusMenuOnNextRender = false;\n\n    if (!this.state.isMenuOpen) {\n      return;\n    }\n\n    const focusedItem = this.state.focusedItem !== null ? [this.state.focusedItem] : [];\n    return React.createElement(Listbox, {\n      id: this.props.listboxId,\n      typeAheadEnabled: false,\n      disabled: this.props.disabled,\n      focusItemOnMount: shouldFocusOnMenu,\n      defaultSelection: focusedItem,\n      onSelectedItemsChanged: this.updateFocusedItem,\n      onItemInvoked: this.handleItemInvoked,\n      onKeyDown: this.handleMenuKeydown,\n      managedClasses: {\n        listbox: autoSuggest_menu,\n        listbox__disabled: autoSuggest__disabled\n      }\n    }, this.renderChildren());\n  }\n\n  renderChildren() {\n    if (this.props.filterSuggestions) {\n      const children = this.props.children;\n      return React.Children.map(children, node => {\n        if (!isNil(node.props)) {\n          if (node.props[AutoSuggest.valuePropertyKey] === undefined) {\n            return node;\n          }\n\n          return this.isMatch(node.props) ? node : null;\n        }\n      });\n    } else {\n      return this.props.children;\n    }\n  }\n  /**\n   * Determine if a single node is a match\n   */\n\n\n  isMatch(node) {\n    if (!isNil(this.storedValueString)) {\n      return node.value.toLowerCase().includes(this.storedValueString.toLowerCase());\n    }\n  }\n\n}\n\nAutoSuggest.displayName = `${DisplayNamePrefix}AutoSuggest`;\nAutoSuggest.defaultProps = {\n  initialValue: \"\",\n  disabled: false,\n  placeholder: \"\",\n  managedClasses: {},\n  filterSuggestions: false\n};\nAutoSuggest.valuePropertyKey = \"value\";\nexport default AutoSuggest;\nexport { AutoSuggestContext };","map":{"version":3,"sources":["/Users/samorcutt/Desktop/bio/node_modules/@microsoft/fast-components-react-base/dist/auto-suggest/auto-suggest.js"],"names":["Foundation","classNames","keyCodeArrowDown","keyCodeArrowUp","keyCodeEnter","keyCodeEscape","keyCodeTab","React","Listbox","TextField","TextFieldType","DisplayNamePrefix","AutoSuggestContext","isNil","AutoSuggest","constructor","props","handledProps","isMenuOpen","disabled","label","inputRegion","managedClasses","initialValue","value","onValueChange","onInvoked","placeholder","listboxId","filterSuggestions","rootElement","createRef","shouldFocusMenuOnNextRender","defaultInputRegionRenderFunction","state","onChange","onClick","onKeyDown","activedescendantId","focusedItem","id","createElement","type","text","role","updateFocusedItem","newSelection","length","setState","updateValue","handleInputRegionClick","e","defaultPrevented","toggleMenu","handleItemInvoked","item","invoke","storedValueString","handleChange","newValue","target","isFromSuggestedOption","handleInputRegionKeydown","keyCode","focusOnMenu","preventDefault","HTMLInputElement","focusOnInput","handleMenuKeydown","checkForMenuEnd","isValidInput","increment","childrenAsArray","Children","toArray","renderChildren","currentItemIndex","getItemIndexById","startIndex","endIndex","nextFocusableItem","getFirstValidOptionInRange","focusFirstItemInRange","validOption","desiredMenuState","updatedIsMenuOpen","validateMenuState","current","inputElements","getElementsByTagName","focus","count","handleWindowClick","event","contains","undefined","componentDidUpdate","prevProps","updatedMenuVisibility","componentDidMount","window","addEventListener","componentWillUnmount","removeEventListener","render","Object","assign","unhandledProps","ref","className","generateClassNames","Provider","currentValue","renderInputRegion","renderMenu","autoSuggest","autoSuggest__disabled","autoSuggest__menuOpen","shouldFocusOnMenu","autoSuggest_menu","typeAheadEnabled","focusItemOnMount","defaultSelection","onSelectedItemsChanged","onItemInvoked","listbox","listbox__disabled","children","map","node","valuePropertyKey","isMatch","toLowerCase","includes","displayName","defaultProps"],"mappings":"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","sourcesContent":["import Foundation from \"@microsoft/fast-components-foundation-react\";\nimport { classNames, keyCodeArrowDown, keyCodeArrowUp, keyCodeEnter, keyCodeEscape, keyCodeTab, } from \"@microsoft/fast-web-utilities\";\nimport React from \"react\";\nimport { Listbox, TextField, TextFieldType } from \"../index\";\nimport { DisplayNamePrefix } from \"../utilities\";\nimport { AutoSuggestContext } from \"./auto-suggest-context\";\nimport { isNil } from \"lodash-es\";\nclass AutoSuggest extends Foundation {\n    /**\n     * constructor\n     */\n    constructor(props) {\n        super(props);\n        /**\n         * Handled props instantiation\n         */\n        this.handledProps = {\n            isMenuOpen: void 0,\n            disabled: void 0,\n            label: void 0,\n            inputRegion: void 0,\n            managedClasses: void 0,\n            initialValue: void 0,\n            value: void 0,\n            onValueChange: void 0,\n            onInvoked: void 0,\n            placeholder: void 0,\n            listboxId: void 0,\n            filterSuggestions: void 0,\n        };\n        this.rootElement = React.createRef();\n        this.shouldFocusMenuOnNextRender = false;\n        /**\n         * The default function that renders an unstyled content display\n         */\n        this.defaultInputRegionRenderFunction = (props, state, onChange, onClick, onKeyDown) => {\n            const listboxId = state.isMenuOpen ? props.listboxId : null;\n            const activedescendantId = state.focusedItem !== null ? state.focusedItem.id : null;\n            return (React.createElement(TextField, { disabled: props.disabled, onChange: onChange, onClick: onClick, onKeyDown: onKeyDown, value: state.value, type: TextFieldType.text, role: \"combobox\", \"aria-label\": props.label || null, \"aria-autocomplete\": \"both\", \"aria-activedescendant\": activedescendantId || null, \"aria-owns\": listboxId || null, \"aria-controls\": listboxId || null }));\n        };\n        /**\n         * Updates selection state and associated values\n         */\n        this.updateFocusedItem = (newSelection) => {\n            if (newSelection.length === 0) {\n                this.setState({\n                    focusedItem: null,\n                });\n            }\n            else {\n                this.setState({\n                    focusedItem: newSelection[0],\n                });\n                this.updateValue(newSelection[0].value, true);\n            }\n        };\n        /**\n         * Handles clicks\n         */\n        this.handleInputRegionClick = (e) => {\n            if (this.props.disabled || e.defaultPrevented) {\n                return;\n            }\n            this.toggleMenu(true);\n        };\n        /**\n         * Handles item invoked\n         */\n        this.handleItemInvoked = (item) => {\n            this.invoke(item.value, item);\n            this.storedValueString = this.state.value;\n            this.toggleMenu(false);\n        };\n        /**\n         * Invokes the auto-select component\n         */\n        this.invoke = (value, item) => {\n            if (typeof this.props.onInvoked === \"function\") {\n                this.props.onInvoked(value, item);\n            }\n        };\n        /**\n         * Handles value changes from input element\n         */\n        this.handleChange = (e) => {\n            const newValue = e.target.value;\n            this.storedValueString = newValue;\n            this.updateValue(newValue, false);\n        };\n        /**\n         * Update the currentValue of the component\n         */\n        this.updateValue = (newValue, isFromSuggestedOption) => {\n            if (typeof this.props.onValueChange === \"function\") {\n                this.props.onValueChange(newValue, isFromSuggestedOption);\n            }\n            if (isNil(this.props.value) && newValue !== this.state.value) {\n                this.toggleMenu(true);\n                this.setState({\n                    value: newValue,\n                });\n            }\n        };\n        /**\n         * Handles input region key events\n         */\n        this.handleInputRegionKeydown = (e) => {\n            if (this.props.disabled || e.defaultPrevented) {\n                return;\n            }\n            switch (e.keyCode) {\n                case keyCodeEnter:\n                    this.invoke(this.state.value, null);\n                    break;\n                case keyCodeEscape:\n                    this.toggleMenu(false);\n                    break;\n                case keyCodeArrowDown:\n                    this.focusOnMenu(1);\n                    e.preventDefault();\n                    break;\n                case keyCodeArrowUp:\n                    this.focusOnMenu(-1);\n                    e.preventDefault();\n                    break;\n                case keyCodeTab:\n                    // Prevent default case handling for tab\n                    break;\n                default:\n                    if (e.target instanceof HTMLInputElement) {\n                        const newValue = e.target.value;\n                        this.updateValue(newValue, false);\n                        this.focusOnInput();\n                        break;\n                    }\n            }\n        };\n        /**\n         * Handles menu key events\n         */\n        this.handleMenuKeydown = (e) => {\n            if (this.props.disabled || e.defaultPrevented) {\n                return;\n            }\n            switch (e.keyCode) {\n                case keyCodeEscape:\n                    this.toggleMenu(false);\n                    break;\n                case keyCodeArrowDown:\n                    if (this.checkForMenuEnd(1) === true) {\n                        e.preventDefault();\n                    }\n                    break;\n                case keyCodeArrowUp:\n                    if (this.checkForMenuEnd(-1) === true) {\n                        e.preventDefault();\n                    }\n                    break;\n                default:\n                    if (this.isValidInput(e)) {\n                        this.focusOnInput();\n                    }\n                    break;\n            }\n        };\n        /**\n         * test if a key press is a valid input\n         */\n        this.isValidInput = (e) => {\n            if (e.keyCode < 8 ||\n                (e.keyCode > 8 && e.keyCode < 48) ||\n                (e.keyCode > 90 && e.keyCode < 96) ||\n                (e.keyCode > 111 && e.keyCode < 186) ||\n                e.keyCode > 222) {\n                return false;\n            }\n            return true;\n        };\n        /**\n         * Passes focus to the input element if focus would bump up against the ends of the menu,\n         * return true if result was focusing on input region\n         */\n        this.checkForMenuEnd = (increment) => {\n            if (this.state.focusedItem === null) {\n                return false;\n            }\n            const childrenAsArray = React.Children.toArray(this.renderChildren());\n            const currentItemIndex = Listbox.getItemIndexById(this.state.focusedItem.id, this.renderChildren());\n            const startIndex = currentItemIndex + increment;\n            if (startIndex > childrenAsArray.length - 1 || startIndex < 0) {\n                this.setState({\n                    value: this.storedValueString,\n                });\n                // at the end of the list, focus on input\n                this.focusOnInput();\n                return true;\n            }\n            const endIndex = increment > -1 ? childrenAsArray.length - 1 : 0;\n            const nextFocusableItem = Listbox.getFirstValidOptionInRange(startIndex, endIndex, childrenAsArray, increment).props;\n            if (nextFocusableItem === null ||\n                nextFocusableItem.id === this.state.focusedItem.id) {\n                this.setState({\n                    value: this.storedValueString,\n                });\n                // at the end of the list, focus on input\n                this.focusOnInput();\n                return true;\n            }\n            return false;\n        };\n        /**\n         * Opens menu and focuses on first or last valid item\n         */\n        this.focusOnMenu = (increment) => {\n            this.storedValueString = this.state.value;\n            const childrenAsArray = React.Children.toArray(this.renderChildren());\n            if (childrenAsArray.length === 0) {\n                return;\n            }\n            const startIndex = increment > -1 ? 0 : childrenAsArray.length - 1;\n            const endIndex = increment > -1 ? childrenAsArray.length - 1 : 0;\n            this.focusFirstItemInRange(startIndex, endIndex, childrenAsArray, increment);\n            this.toggleMenu(true);\n            this.shouldFocusMenuOnNextRender = true;\n        };\n        /**\n         * Gets first child in a range\n         */\n        this.focusFirstItemInRange = (startIndex, endIndex, childrenAsArray, increment) => {\n            const validOption = Listbox.getFirstValidOptionInRange(startIndex, endIndex, childrenAsArray, increment);\n            if (validOption !== null) {\n                this.updateFocusedItem([validOption.props]);\n            }\n        };\n        /**\n         * Toggles the menu\n         */\n        this.toggleMenu = (desiredMenuState) => {\n            const updatedIsMenuOpen = this.validateMenuState(desiredMenuState);\n            if (updatedIsMenuOpen !== this.state.isMenuOpen) {\n                this.setState({\n                    isMenuOpen: updatedIsMenuOpen,\n                });\n                if (this.state.isMenuOpen && !updatedIsMenuOpen) {\n                    this.setState({\n                        value: this.storedValueString,\n                    });\n                    this.focusOnInput();\n                }\n            }\n        };\n        /**\n         * Focus on the input element\n         */\n        this.focusOnInput = () => {\n            if (this.rootElement.current === null) {\n                return;\n            }\n            const inputElements = this.rootElement.current.getElementsByTagName(\"input\");\n            if (inputElements.length > 0) {\n                inputElements[0].focus();\n            }\n            this.updateFocusedItem([]);\n        };\n        /**\n         * Determine menu state by comparing desired state to props\n         */\n        this.validateMenuState = (desiredMenuState) => {\n            return typeof this.props.isMenuOpen === \"boolean\"\n                ? this.props.isMenuOpen\n                : React.Children.count(this.renderChildren()) === 0\n                    ? false\n                    : desiredMenuState;\n        };\n        /**\n         * Close the menu when when there are clicks outside\n         */\n        this.handleWindowClick = (event) => {\n            if (this.state.isMenuOpen &&\n                this.rootElement.current !== null &&\n                !this.rootElement.current.contains(event.target)) {\n                this.toggleMenu(false);\n            }\n        };\n        const value = this.props.value === undefined ? this.props.initialValue : this.props.value;\n        this.state = {\n            value,\n            focusedItem: null,\n            isMenuOpen: this.validateMenuState(false),\n        };\n        this.storedValueString = value;\n    }\n    componentDidUpdate(prevProps) {\n        const updatedMenuVisibility = this.validateMenuState(this.state.isMenuOpen);\n        if (updatedMenuVisibility !== this.state.isMenuOpen) {\n            this.toggleMenu(updatedMenuVisibility);\n        }\n        if (this.props.value !== prevProps.value) {\n            this.setState({\n                value: this.props.value,\n            });\n        }\n    }\n    componentDidMount() {\n        window.addEventListener(\"click\", this.handleWindowClick);\n    }\n    componentWillUnmount() {\n        window.removeEventListener(\"click\", this.handleWindowClick);\n    }\n    /**\n     * Renders the component\n     */\n    render() {\n        return (React.createElement(\"div\", Object.assign({}, this.unhandledProps(), { ref: this.rootElement, className: this.generateClassNames() }),\n            React.createElement(AutoSuggestContext.Provider, { value: {\n                    currentValue: this.storedValueString,\n                } },\n                this.renderInputRegion(),\n                this.renderMenu())));\n    }\n    /**\n     * Create class names\n     */\n    generateClassNames() {\n        const { autoSuggest, autoSuggest__disabled, autoSuggest__menuOpen, } = this.props.managedClasses;\n        return super.generateClassNames(classNames(autoSuggest, [autoSuggest__disabled, this.props.disabled], [autoSuggest__menuOpen, this.state.isMenuOpen]));\n    }\n    /**\n     * Determine which function to use to render content display (ie. the part of the control that shows when the menu isn't open)\n     * and invokes it\n     */\n    renderInputRegion() {\n        if (typeof this.props.inputRegion === \"function\") {\n            return this.props.inputRegion(this.props, this.state, this.handleChange, this.handleInputRegionClick, this.handleInputRegionKeydown);\n        }\n        else {\n            return this.defaultInputRegionRenderFunction(this.props, this.state, this.handleChange, this.handleInputRegionClick, this.handleInputRegionKeydown);\n        }\n    }\n    /**\n     * Determine which function to use to render the menu and invokes it\n     */\n    renderMenu() {\n        const shouldFocusOnMenu = this.shouldFocusMenuOnNextRender;\n        const { autoSuggest_menu, autoSuggest__disabled, } = this.props.managedClasses;\n        this.shouldFocusMenuOnNextRender = false;\n        if (!this.state.isMenuOpen) {\n            return;\n        }\n        const focusedItem = this.state.focusedItem !== null ? [this.state.focusedItem] : [];\n        return (React.createElement(Listbox, { id: this.props.listboxId, typeAheadEnabled: false, disabled: this.props.disabled, focusItemOnMount: shouldFocusOnMenu, defaultSelection: focusedItem, onSelectedItemsChanged: this.updateFocusedItem, onItemInvoked: this.handleItemInvoked, onKeyDown: this.handleMenuKeydown, managedClasses: {\n                listbox: autoSuggest_menu,\n                listbox__disabled: autoSuggest__disabled,\n            } }, this.renderChildren()));\n    }\n    renderChildren() {\n        if (this.props.filterSuggestions) {\n            const children = this.props.children;\n            return React.Children.map(children, (node) => {\n                if (!isNil(node.props)) {\n                    if (node.props[AutoSuggest.valuePropertyKey] === undefined) {\n                        return node;\n                    }\n                    return this.isMatch(node.props) ? node : null;\n                }\n            });\n        }\n        else {\n            return this.props.children;\n        }\n    }\n    /**\n     * Determine if a single node is a match\n     */\n    isMatch(node) {\n        if (!isNil(this.storedValueString)) {\n            return node.value\n                .toLowerCase()\n                .includes(this.storedValueString.toLowerCase());\n        }\n    }\n}\nAutoSuggest.displayName = `${DisplayNamePrefix}AutoSuggest`;\nAutoSuggest.defaultProps = {\n    initialValue: \"\",\n    disabled: false,\n    placeholder: \"\",\n    managedClasses: {},\n    filterSuggestions: false,\n};\nAutoSuggest.valuePropertyKey = \"value\";\nexport default AutoSuggest;\nexport { AutoSuggestContext };\n"]},"metadata":{},"sourceType":"module"}